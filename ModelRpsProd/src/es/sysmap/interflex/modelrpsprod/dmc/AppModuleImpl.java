package es.sysmap.interflex.modelrpsprod.dmc;
import es.sysmap.interflex.model.dmc.ProdembalajesViewImpl;
import es.sysmap.interflex.model.dmc.ProdembalajesViewRowImpl;
import es.sysmap.interflex.model.dmc.ProdembalajesreferenciaViewRowImpl;
import oracle.jbo.AttributeDef;
import oracle.jbo.Key;
import oracle.jbo.Row;
import oracle.jbo.client.Configuration;
import oracle.jbo.server.ApplicationModuleImpl;
import oracle.jbo.domain.Number;
//  ---------------------------------------------------------------------
//  ---    File generated by Oracle ADF Business Components Design Time.
//  ---    Custom code may be added to this class.
//  ---    Warning: Do not modify method signatures of generated methods.
//  ---------------------------------------------------------------------

public class AppModuleImpl extends ApplicationModuleImpl implements es.sysmap.interflex.modelrpsprod.dmc.common.AppModule 
{

    private static final String amDef = "es.sysmap.interflex.model.dmc.AppModule";
    private static final String config = "AppModuleLocal";
    private static es.sysmap.interflex.model.dmc.AppModuleImpl appModuleSga = null;

  /**
   * 
   *  This is the default constructor (do not remove)
   */
  public AppModuleImpl()
  {
  }

 public es.sysmap.interflex.model.dmc.AppModuleImpl getAppModuleSga() 
  {
      if (appModuleSga == null)
          appModuleSga = (es.sysmap.interflex.model.dmc.AppModuleImpl)Configuration.createRootApplicationModule(amDef,config);
 
      return appModuleSga;
  }
  
  /**
   * 
   *  Container's getter for EmbalajesView1
   */
  public EmbalajesViewImpl getEmbalajesView1()
  {
    return (EmbalajesViewImpl)findViewObject("EmbalajesView1");
  }

  /**
   * 
   *  Container's getter for EmbalajesreferenciaView1
   */
  public EmbalajesreferenciaViewImpl getEmbalajesreferenciaView1()
  {
    return (EmbalajesreferenciaViewImpl)findViewObject("EmbalajesreferenciaView1");
  }
  
  
    public void updateEmbalajes () 
  {
    EmbalajesViewImpl emb = getEmbalajesView1();
    emb.executeQuery();
    es.sysmap.interflex.model.dmc.AppModuleImpl app = getAppModuleSga();

    while (emb.hasNext()) 
    {
      EmbalajesViewRowImpl row = (EmbalajesViewRowImpl)emb.next();
      Integer id = (Integer)row.getAttribute("Idformato");
      Number numId = new Number(id.intValue());
      
      Object [] obj = {numId};
      Number idFormato = new Number(row.getIdformato().intValue());

     
      
      Key idKey = new Key(obj); 
      
      ProdembalajesViewRowImpl prodEmbalaje = null;
      Row [] rows = app.getProdembalajesView1().findByKey(idKey, 1);
      if (rows != null && rows.length > 0) 
      {
        prodEmbalaje = (ProdembalajesViewRowImpl)rows[0];

        try 
        {
            
          prodEmbalaje.setIdformato(new Number(row.getIdformato()));
          prodEmbalaje.setRefformato(row.getRefformato());
          if (row.getAlto() != null)
            prodEmbalaje.setAlto(new Number(row.getAlto()));
          if (row.getAncho() != null)
            prodEmbalaje.setAncho(new Number(row.getAncho()));

          prodEmbalaje.setDescripcion(row.getDescripcion());
          if (row.getEp() != null)
            prodEmbalaje.setEp(new Number(row.getEp()));
  
           }
        catch (java.sql.SQLException ex) 
        {
          // TODO
        }
        
        
      }
      else
      {    
        prodEmbalaje = (ProdembalajesViewRowImpl)app.getProdembalajesView1().createRow();
        try 
        {
          if (row.getIdformato() != null)
            prodEmbalaje.setIdformato(new Number(row.getIdformato()));
          prodEmbalaje.setRefformato(row.getRefformato());
          if (row.getAlto() != null)
            prodEmbalaje.setAlto(new Number(row.getAlto()));
          if (row.getAncho() != null)
            prodEmbalaje.setAncho(new Number(row.getAncho()));
          prodEmbalaje.setDescripcion(row.getDescripcion());
          if (row.getEp() != null)
            prodEmbalaje.setEp(new Number(row.getEp()));
        }
        catch (java.sql.SQLException ex) 
        {
          // TODO
        }

        app.getProdembalajesView1().insertRow(prodEmbalaje);
      }

    }
    
    app.getTransaction().commit();
  }
  
  
     public void updateEmbalajesReferencia () 
  {
    EmbalajesreferenciaViewImpl embref = getEmbalajesreferenciaView1();
    embref.executeQuery();
    es.sysmap.interflex.model.dmc.AppModuleImpl app = getAppModuleSga();

    while (embref.hasNext()) 
    {
      EmbalajesreferenciaViewRowImpl row = (EmbalajesreferenciaViewRowImpl)embref.next();
      Integer idformato = (Integer)row.getIdformato();
      Number numIdformato = new Number(idformato.intValue());
      
      Integer cantidad = (Integer)row.getCantidad();
      Number numCantidad = new Number(cantidad.intValue());
      
      String codart = row.getCodart();
      
      Object [] obj = {codart, numIdformato, numCantidad};
      
      
      
      Key rpsEmbalajeReferencia = row.getKey();
      
      
      
     
      
      Key idKey = new Key(obj); 
      
      ProdembalajesreferenciaViewRowImpl prodEmbalajereferencia = null;

      Row [] rows = app.getProdembalajesreferenciaView2().findByKey(idKey, 1);
      if (rows != null && rows.length > 0) 
      {
        prodEmbalajereferencia = (ProdembalajesreferenciaViewRowImpl)rows[0];
        
        try 
        {
            
          prodEmbalajereferencia.setCantidad(numCantidad);
          if (row.getPredet() != null)
            prodEmbalajereferencia.setPredet(new Number(row.getPredet()));
          prodEmbalajereferencia.setUnidadmedida(row.getUnidadmedida());
        
  
           }
        catch (java.sql.SQLException ex) 
        {
          // TODO
        }
        
        
        
      }
      else
      {   
      
        prodEmbalajereferencia = (ProdembalajesreferenciaViewRowImpl)app.getProdembalajesreferenciaView2().createRow();
 
        try 
        {
          
          if (row.getIdformato() != null)
            prodEmbalajereferencia.setIdformato(new Number(row.getIdformato()));
          prodEmbalajereferencia.setCantidad(numCantidad);
          prodEmbalajereferencia.setCodart(codart);
          if (row.getPredet() != null)
            prodEmbalajereferencia.setPredet(new Number(row.getPredet()));
          prodEmbalajereferencia.setUnidadmedida(row.getUnidadmedida());
            
        }
        catch (java.sql.SQLException ex) 
        {
          // TODO
        }

        app.getProdembalajesreferenciaView2().insertRow(prodEmbalajereferencia);
        
      }

    }
    
    app.getTransaction().commit();
  }

  /**
   * 
   *  Sample main for debugging Business Components code using the tester.
   */
  public static void main(String[] args)
  {
    launchTester("es.sysmap.interflex.modelrpsprod.dmc", "AppModuleLocal");
  }
  
  
}