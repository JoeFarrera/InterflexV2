package es.sysmap.interflex.model.bdc;
import oracle.jbo.Key;
import oracle.jbo.server.DBTransaction;
import oracle.jbo.server.EntityDefImpl;
//  ---------------------------------------------------------------------
//  ---    File generated by Oracle ADF Business Components Design Time.
//  ---    Custom code may be added to this class.
//  ---    Warning: Do not modify method signatures of generated methods.
//  ---------------------------------------------------------------------

public class SgastockDefImpl extends EntityDefImpl 
{
  /**
   * 
   *  This is the default constructor (do not remove)
   */
  public SgastockDefImpl()
  {
  }
  
  public SgastockImpl crearStockInicial(DBTransaction txn, 
                                   String idart)
  {
    // La entidad ya crea la clave primaria a partir de una secuencia
    SgastockImpl stock = (SgastockImpl)super.createInstance(txn, null);
    stock.afegirStockInicial(idart);
    return stock;
  }
 
 
  /**
   * Actualitza l'estat de l'stock per a que s'envii al host
   * @return 
   * @param referencia
   * @param iddoc
   * @param txn
   * @param estat: A (actualitza codi) , H (no actualitza codi), B (baixa)
   */

  public boolean actualitzarStock(DBTransaction txn, 
                                   String idart, String estat) 
  {
    boolean actualitzat = true;
    try
    {
      Object [] obj = {idart};
      Key key = new Key(obj); 
      SgastockImpl stock = (SgastockImpl)findByPrimaryKey(txn, key);
      if (stock != null)
      {
        stock.setEstado(estat);
        // Si l'estat es B (baixa), guardem el codi de la referencia a la taula
        // stock, perque poder esborrar-lo de la taula stocks del host
        if (estat.equals("B"))
          stock.setIdartifb(stock.getIdartif());
      }
    }
    catch(Exception ex)
    {
      actualitzat = false;      
    }
    return actualitzat;
  }  
  
}